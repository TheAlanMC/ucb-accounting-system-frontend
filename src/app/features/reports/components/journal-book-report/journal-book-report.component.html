<app-sidebar (navbarToggle)="onNavbarToggle($event)" ></app-sidebar>

<div class="home-section" [class.navbar-opened]="isNavbarOpen">
  <div class="card" >
    <p-toast></p-toast>
    <div class="flex card-container overflow-hidden">
      <div class="page-title flex-grow-1  flex align-items-center justify-content-start font-bold m-2 px-5 py-0">
        <i class="pi pi-money-bill" style="color: var(--color-green); font-size: 2.5rem; z-index: 2 !important;"></i>
        <p class="text-2xl md:text-3xl" style="z-index:2;" >&nbsp;&nbsp;&nbsp;Libro Diario</p>
      </div>
      <div class="flex-none flex align-items-center justify-content-center font-bold m-2 px-5 py-3">
        <!-- <p-button class="help-icon" icon="pi pi-question-circle" styleClass="p-button-success"></p-button> -->
        <app-navbar></app-navbar>
      </div>
    </div>

  </div>
  <div class="col-12 xl:col-12 px-8 py-3">
    <h4 style="color: #8c8c8c;">Reporte por rango de fechas</h4>
    <div class="flex justify-content-between">
        <div class="flex flex-row flex-wrap mb-3">
          <div class="flex flex-column justify-content-start mr-2">
            <p>Desde:</p>
            <p-calendar class="datepicker" [(ngModel)]="startDate" (onSelect)="filterByDate($event)" (onClearClick)=filterByDate(null)
                        [showButtonBar]="true" [showIcon]="true" dateFormat="dd/mm/yy" inputId="icon" placeholder="Seleccione una fecha"
                        [readonlyInput]="true" dateFormat="yy-mm-dd"></p-calendar>
          </div>
          <div class="flex flex-column justify-content-start mr-2">
            <p>Hasta:</p>
            <p-calendar class="datepicker" [(ngModel)]="endDate"  (onSelect)="filterByDate($event)" (onClearClick)=filterByDate(null)
                        [showButtonBar]="true" [showIcon]="true" dateFormat="dd/mm/yy" inputId="icon" placeholder="Seleccione una fecha"
                        [readonlyInput]="true" dateFormat="yy-mm-dd"></p-calendar>
          </div>
        </div>
        <div class="flex flex-column justify-content-start">
            <div class="flex justify-content-between flex-wrap card-container purple-container">
<!--                    <p-splitButton #ua label="Documento Contable" class="green-button mr-4"  [model]="items"></p-splitButton>-->
                    <p-button label="Generar Reporte" class="green-button" (onClick)="generateReport()"></p-button>
              <span class="ml-2"></span>
                    <p-button label="Exportar" class="green-button" (onClick)="exportPdf()"></p-button>
            </div>
        </div>
    </div>
    <br>

    <p-table  class="p-table-noborder" [value]="reportDatas" sortField="journalEntryId" sortMode="single" [scrollable]="true"  [tableStyle]="{'min-width': '50rem'}" rowGroupMode="subheader" groupRowsBy="journalEntryId" [customSort]="true">
        <ng-template pTemplate="header">
            <tr>
                <th>Fecha</th>
                <th>Codigo</th>
                <th>Nombre</th>
                <th>Referencia</th>
                <th>Debe (Bs.)</th>
                <th>Haber (Bs.)</th>
            </tr>

        </ng-template>
        <ng-template pTemplate="groupheader" let-reportDatas>
            <tr pRowGroupHeader>
                <td colspan="1">
                    <span class="font-bold ml-2">{{reportDatas.transactionDate}}</span>
                </td>
                <td colspan="5">
                    <span class="font-bold ml-2">Comprobante de {{reportDatas.documentType.documentTypeName}}</span>
                </td>
            </tr>
        </ng-template>
<!--        <ng-template pTemplate="groupfooter" let-reportData>-->
<!--            <tr pRowGroupHeader >-->
<!--                <td id="borderblack" colspan="1">-->
<!--                    <span class="font-bold ml-2"></span>-->
<!--                </td>-->
<!--                <td id="borderblack" colspan="3">-->
<!--                    <span class="font-bold ml-2">Suma</span>-->
<!--                </td>-->
<!--                <td id="borderblack" colspan="1">-->
<!--                    <span class="font-bold ml-2">5000</span>-->
<!--                </td>-->
<!--                <td id="borderblack" colspan="1">-->
<!--                    <span class="font-bold ml-2">4000</span>-->
<!--                </td>-->

<!--            </tr>-->


<!--        </ng-template>-->

        <ng-template pTemplate="body" let-reportDatas let-rowIndex="rowIndex">
            <tr *ngFor="let transaction of reportDatas.transactionDetails">
                <td id="bordernone"></td>
                <td id="bordernone">{{ transaction.subaccount.subaccountCode }}</td>
                <td id="bordernone">{{ transaction.subaccount.subaccountName }}</td>
                <td id="bordernone">{{ reportDatas.description }}</td>
                <td id="bordernone">{{ transaction.debitAmountBs | currency: ' '}}</td>
                <td id="bordernone">{{ transaction.creditAmountBs | currency: ' ' }}</td>

                <!-- Agrega más columnas según tus datos -->
              </tr>
        </ng-template>
    </p-table>
  </div>
</div>
